//@version=6
indicator("Crypto Price Volatility Range", overlay=false)

// Settings
length = input.int(20, "Period", minval=1)
mult = input.float(1.0, "Standard Deviation Multiplier", minval=0.1, step=0.1)
showLabels = input.bool(true, "Show Labels")

// Symbol Settings
btc = request.security("BTCUSD", timeframe.period, close)
eth = request.security("ETHUSD", timeframe.period, close)
avax = request.security("AVAXUSD", timeframe.period, close)
doge = request.security("DOGEUSD", timeframe.period, close)
hype = request.security("HYPEUSD", timeframe.period, close)
xrp = request.security("XRPUSD", timeframe.period, close)
bnb = request.security("BNBUSD", timeframe.period, close)
ada = request.security("ADAUSD", timeframe.period, close)
trx = request.security("TRXUSD", timeframe.period, close)
link = request.security("LINKUSD", timeframe.period, close)
shib = request.security("SHIBUSD", timeframe.period, close)
ton = request.security("TONUSD", timeframe.period, close)
sui = request.security("SUIUSD", timeframe.period, close)
xlm = request.security("XLMUSD", timeframe.period, close)

// Historical Volatility Calculation Function
calcVolRange(src) =>
    ret = math.log(src / src[1])
    stdDev = ta.stdev(ret, length) * math.sqrt(252) * 100
    volatilityRange = stdDev * mult

// Calculate Price Volatility Range for Each Currency Pair
btcRange = calcVolRange(btc)
ethRange = calcVolRange(eth)
avaxRange = calcVolRange(avax)
dogeRange = calcVolRange(doge)
hypeRange = calcVolRange(hype)
xrpRange = calcVolRange(xrp)
bnbRange = calcVolRange(bnb)
adaRange = calcVolRange(ada)
trxRange = calcVolRange(trx)
linkRange = calcVolRange(link)
shibRange = calcVolRange(shib)
tonRange = calcVolRange(ton)
suiRange = calcVolRange(sui)
xlmRange = calcVolRange(xlm)

// Color Settings
var color btcColor = color.new(color.blue, 0)
var color ethColor = color.new(color.green, 0)
var color avaxColor = color.new(color.red, 0)
var color dogeColor = color.new(color.yellow, 0)
var color hypeColor = color.new(color.purple, 0)
var color xrpColor = color.new(color.orange, 0)
var color bnbColor = color.new(color.teal, 0)
var color adaColor = color.new(color.maroon, 0)
var color trxColor = color.new(color.lime, 0)
var color linkColor = color.new(color.navy, 0)
var color shibColor = color.new(color.fuchsia, 0)
var color tonColor = color.new(color.aqua, 0)
var color suiColor = color.new(color.olive, 0)
var color xlmColor = color.new(color.silver, 0)

// Plots
btcPlot = plot(btcRange, "BTC Volatility", color=btcColor, linewidth=2)
ethPlot = plot(ethRange, "ETH Volatility", color=ethColor, linewidth=2)
avaxPlot = plot(avaxRange, "AVAX Volatility", color=avaxColor, linewidth=2)
dogePlot = plot(dogeRange, "DOGE Volatility", color=dogeColor, linewidth=2)
hypePlot = plot(hypeRange, "HYPE Volatility", color=hypeColor, linewidth=2)
xrpPlot = plot(xrpRange, "XRP Volatility", color=xrpColor, linewidth=2)
bnbPlot = plot(bnbRange, "BNB Volatility", color=bnbColor, linewidth=2)
adaPlot = plot(adaRange, "ADA Volatility", color=adaColor, linewidth=2)
trxPlot = plot(trxRange, "TRX Volatility", color=trxColor, linewidth=2)
linkPlot = plot(linkRange, "LINK Volatility", color=linkColor, linewidth=2)
shibPlot = plot(shibRange, "SHIB Volatility", color=shibColor, linewidth=2)
tonPlot = plot(tonRange, "TON Volatility", color=tonColor, linewidth=2)
suiPlot = plot(suiRange, "SUI Volatility", color=suiColor, linewidth=2)
xlmPlot = plot(xlmRange, "XLM Volatility", color=xlmColor, linewidth=2)

// Labels
if showLabels
    var label btcLabel = label.new(bar_index, btcRange, "", color=color.new(color.blue, 90), style=label.style_label_left, textcolor=btcColor)
    var label ethLabel = label.new(bar_index, ethRange, "", color=color.new(color.green, 90), style=label.style_label_left, textcolor=ethColor)
    var label avaxLabel = label.new(bar_index, avaxRange, "", color=color.new(color.red, 90), style=label.style_label_left, textcolor=avaxColor)
    var label dogeLabel = label.new(bar_index, dogeRange, "", color=color.new(color.yellow, 90), style=label.style_label_left, textcolor=dogeColor)
    var label hypeLabel = label.new(bar_index, hypeRange, "", color=color.new(color.purple, 90), style=label.style_label_left, textcolor=hypeColor)
    var label xrpLabel = label.new(bar_index, xrpRange, "", color=color.new(color.orange, 90), style=label.style_label_left, textcolor=xrpColor)
    var label bnbLabel = label.new(bar_index, bnbRange, "", color=color.new(color.teal, 90), style=label.style_label_left, textcolor=bnbColor)
    var label adaLabel = label.new(bar_index, adaRange, "", color=color.new(color.maroon, 90), style=label.style_label_left, textcolor=adaColor)
    var label trxLabel = label.new(bar_index, trxRange, "", color=color.new(color.lime, 90), style=label.style_label_left, textcolor=trxColor)
    var label linkLabel = label.new(bar_index, linkRange, "", color=color.new(color.navy, 90), style=label.style_label_left, textcolor=linkColor)
    var label shibLabel = label.new(bar_index, shibRange, "", color=color.new(color.fuchsia, 90), style=label.style_label_left, textcolor=shibColor)
    var label tonLabel = label.new(bar_index, tonRange, "", color=color.new(color.aqua, 90), style=label.style_label_left, textcolor=tonColor)
    var label suiLabel = label.new(bar_index, suiRange, "", color=color.new(color.olive, 90), style=label.style_label_left, textcolor=suiColor)
    var label xlmLabel = label.new(bar_index, xlmRange, "", color=color.new(color.silver, 90), style=label.style_label_left, textcolor=xlmColor)
    
    label.set_xy(btcLabel, bar_index, btcRange)
    label.set_text(btcLabel, "BTC: " + str.tostring(btcRange, "#.##") + "%")
    label.set_xy(ethLabel, bar_index, ethRange)
    label.set_text(ethLabel, "ETH: " + str.tostring(ethRange, "#.##") + "%")
    label.set_xy(avaxLabel, bar_index, avaxRange)
    label.set_text(avaxLabel, "AVAX: " + str.tostring(avaxRange, "#.##") + "%")
    label.set_xy(dogeLabel, bar_index, dogeRange)
    label.set_text(dogeLabel, "DOGE: " + str.tostring(dogeRange, "#.##") + "%")
    label.set_xy(hypeLabel, bar_index, hypeRange)
    label.set_text(hypeLabel, "HYPE: " + str.tostring(hypeRange, "#.##") + "%")
    label.set_xy(xrpLabel, bar_index, xrpRange)
    label.set_text(xrpLabel, "XRP: " + str.tostring(xrpRange, "#.##") + "%")
    label.set_xy(bnbLabel, bar_index, bnbRange)
    label.set_text(bnbLabel, "BNB: " + str.tostring(bnbRange, "#.##") + "%")
    label.set_xy(adaLabel, bar_index, adaRange)
    label.set_text(adaLabel, "ADA: " + str.tostring(adaRange, "#.##") + "%")
    label.set_xy(trxLabel, bar_index, trxRange)
    label.set_text(trxLabel, "TRX: " + str.tostring(trxRange, "#.##") + "%")
    label.set_xy(linkLabel, bar_index, linkRange)
    label.set_text(linkLabel, "LINK: " + str.tostring(linkRange, "#.##") + "%")
    label.set_xy(shibLabel, bar_index, shibRange)
    label.set_text(shibLabel, "SHIB: " + str.tostring(shibRange, "#.##") + "%")
    label.set_xy(tonLabel, bar_index, tonRange)
    label.set_text(tonLabel, "TON: " + str.tostring(tonRange, "#.##") + "%")
    label.set_xy(suiLabel, bar_index, suiRange)
    label.set_text(suiLabel, "SUI: " + str.tostring(suiRange, "#.##") + "%")
    label.set_xy(xlmLabel, bar_index, xlmRange)
    label.set_text(xlmLabel, "XLM: " + str.tostring(xlmRange, "#.##") + "%")
